upstream mj {
	server 127.0.0.1:8877 fail_timeout=0;
}

# Handle everything
server {
	listen 80;
	listen [::]:80;
	server_name ~m(iniature)?-j(ourney)?\.netblast\.me$;

	access_log /home/tvalentim/miniature-journey/logs/access.log;
	error_log /home/tvalentim/miniature-journey/logs/error.log;

	# SSL configuration
	#
	# listen 443 ssl default_server;
	# listen [::]:443 ssl default_server;
	#
	# Self signed certs generated by the ssl-cert package
	# Don't use them in a production server!
	#
	# include snippets/snakeoil.conf;


	location / {
		root /var/www/miniature-journey;
		# First attempt to serve request as file, then
		# as directory, then call app if available,
		# otherwise fall back to displaying a 404.
		try_files $uri $uri/ @miniature;
	}

	location /test {
		autoindex on;
	}
	location @miniature {
		proxy_pass		http://mj;	
	}
}
